```{r message = FALSE}
library(dplyr)
library(forecast)
```


# Importations des données 

Tout d'abord, on importe les données et on sélectionne les données concernant la France. 

```{r eval=FALSE, include=FALSE}
donnees <- read.csv("owid-covid-data.csv",sep=",",stringsAsFactors = T)
donnees_modif <- donnees |> 
  filter(iso_code == "FRA") |> 
  select(date,new_cases)
summary(donnees_modif)

write.table(x = donnees_modif, file = "covid_france.csv", sep = ",")
```


```{r}
donnees_fr <- read.csv("covid_france.csv",sep=",")
summary(donnees_fr)
```
Les données ci-dessus comprennent une variable temporelle et une variable caractérisée par un enregistrement journalier des nouveaux cas de Covid-19 en France. 

```{r}
min(donnees_fr$date)
max(donnees_fr$date)
```
Grâce à cette étape, nous pouvons observer que notre série temporelle débute le 1er Mars 2020 et se termine le 19 Avril 2023. Notre étude a donc une plage d'environ de 3 ans.

## Transformation des données en série temporelle

Premièrement, nous allons transformer nos données en séries temporelles pour pouvoir réaliser notre analyse. 

```{r}
ts_donnees_fr <- ts(donnees_fr$new_cases,start = c(2020,1,3), frequency = 365)
# class(ts_donnees_fr)
```

# Première partie 

```{r}
plot(ts_donnees_fr)
```
Ce premier graphique nous montre une hausse brutale des cas de covids en 2022. Afin de pouvoir continuer notre analyse de façon cohérente, nous allons diviser notre série en 2 parties : avant et après 2022.  



Nous décidons de créer trois sous-séries de notre série initiale afin de pouvoir réaliser le traitement des données. Notre objectif est d'isoler le cas particulier de l'année 2022 pour avoir une étude correcte.

```{r}
serie1 <- donnees_fr |> 
  filter(date<="2021-12-22")
# serie1
ts_serie1 <- ts(serie1$new_cases,start = c(2020,1,3), frequency = 365)



serie2 <- donnees_fr |> 
  filter(date>"2021-12-22", date<="2023-01-05")
# serie2

ts_serie2 <- ts(serie2$new_cases,start = c(2021,31,12), frequency = 365)



serie3 <- donnees_fr |> 
  filter(date>"2023-01-05")

ts_serie3 <- ts(serie3$new_cases,start = c(2023,2,5), frequency = 365)
```


```{r}
plot(ts_serie1)
```

```{r}
plot(ts_serie2)
```

```{r}
plot(ts_serie3)
```

Grâce à cette division, nous allons pouvoir étudier chaque sous-série pertinemment.



```{r}

```























```{r}
ts_donnees_fr |> 
  ggtsdisplay(
    plot.type = "scatter")
```

- ACF : pas de corrélation par mois (plus sur une période, sur plusieurs mois)
- Nuage de points à moitié aligné --> corrélation 


```{r}
forecast::gglagplot(ts_donnees_fr,lags=12,do.lines = FALSE)
```

On essaie de transformer notre variable : 

```{r}
log_donnees <- log(ts_donnees_fr)
```

```{r}
plot(log_donnees)
ggtsdisplay(log_donnees)
```

```{r}
carre_donnees <- ts_donnees_fr^2
plot(carre_donnees)
ggtsdisplay(carre_donnees)
```


- Essayer de trouver un modèle qui lisse les données 